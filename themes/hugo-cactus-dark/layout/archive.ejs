<% if (site.tags.length) { %>
  <div class="tagcloud-wrap">
    <%- tagcloud() %>
  </div>
<% } %>

<div id="archive">
  <ul class="post-list">
      <% if (page.path !== 'categories/reprint/index.html') { %>

        <% var year = 0 %>
        <% var change = false %>
        <% page.posts.filter(function(item){return (page.path==='archives/index.html'?!item.reprint:true)}).sort('date', 'desc').each(function(post) { %>
          <% var itemYear = date(post.date, 'YYYY') - 0 %>
          <% change = year !== itemYear %>
          <% year = change ? itemYear : year %>
          <% if (change) { %>
            <h2><%= year %></h2>
          <% } %>
          <li class="post-item">
            <%- partial('_partial/post/date', { post: post, class_name: 'meta' }) %>
            <span><%- partial('_partial/post/title', { post: post, index: true, class_name: '' }) %><span>
          </li>
        <% }); %>

      <% } else{ %>
        <% var day = 0 %>
        <% var change = false %>
        <% page.posts.filter(function(item){return (page.path==='archives/index.html'?!item.reprint:true)}).sort('date', 'desc').each(function(post) { %>
          <% var itemDay = date(post.date, 'YYYY-MM-DD') %>
          <% change = day !== itemDay %>
          <% day = change ? itemDay : day %>
          <% if (change) { %>
            <h2><%= day %></h2>
          <% } %>
          <li class="post-item">
            <%- partial('_partial/post/date', { post: post, class_name: 'meta' }) %>
            <span><%- partial('_partial/post/title', { post: post, index: true, class_name: '' }) %><span>
          </li>
        <% }); %>


      <% } %>

  </ul>
  <%- partial('_partial/pagination') %>
</div>
